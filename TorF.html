<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Math Game - Ultimate</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #3498db;
            --green: #2ecc71;
            --red: #e74c3c;
            --bg: #ecf0f1;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            user-select: none;
        }

        /* --- SCREENS --- */
        .screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none; /* Hidden by default */
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: white;
            z-index: 10;
        }

        /* Show the active screen */
        .screen.active {
            display: flex;
        }

        /* --- START SCREEN --- */
        #start-screen h1 {
            font-size: 4rem;
            color: var(--primary);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .menu-btn {
            width: 200px;
            padding: 15px;
            margin: 10px;
            font-size: 1.2rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.1s;
        }

        .btn-start { background-color: var(--accent); color: white; }
        .btn-options { background-color: #95a5a6; color: white; }
        .menu-btn:active { transform: scale(0.95); }

        /* --- OPTIONS SCREEN --- */
        .option-group {
            text-align: center;
            margin-bottom: 30px;
            width: 80%;
            max-width: 400px;
        }

        label {
            font-size: 1.5rem;
            color: var(--primary);
            display: block;
            margin-bottom: 15px;
        }

        input[type=range] {
            width: 100%;
            margin-bottom: 10px;
            cursor: pointer;
        }

        .value-display {
            font-size: 2rem;
            font-weight: bold;
            color: var(--accent);
        }

        /* --- GAME UI --- */
        #game-screen {
            background-color: #fff;
        }

        #timer-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 25px;
            background-color: #ddd;
        }

        #timer-bar {
            height: 100%;
            width: 100%;
            background: linear-gradient(90deg, #f1c40f, #e67e22);
        }

        #q-number-display {
            position: absolute;
            top: 40px;
            left: 20px;
            font-size: 1.8rem;
            font-weight: 800;
            color: #555;
            background: #eee;
            padding: 8px 15px;
            border-radius: 8px;
            border-left: 5px solid var(--accent);
        }

        #question-text {
            font-size: 3rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 60px;
            padding: 0 20px;
            color: #222;
            font-family: 'Times New Roman', Times, serif; /* Math looks better here */
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-container {
            display: flex;
            gap: 20px;
            width: 90%;
            max-width: 600px;
            height: 180px;
        }

        .game-btn {
            flex: 1;
            font-size: 2.5rem;
            font-weight: bold;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            color: white;
            text-transform: uppercase;
            box-shadow: 0 6px 0 rgba(0,0,0,0.15);
            transition: all 0.1s;
        }

        .game-btn:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 rgba(0,0,0,0.15);
        }

        #btn-true { background-color: var(--green); }
        #btn-false { background-color: var(--red); }

        /* --- LOSER SCREEN --- */
        #loser-screen {
            background-color: black;
            z-index: 50;
        }

        #loser-text {
            color: #ff0000;
            font-size: 8rem;
            font-weight: 900;
            font-family: Impact, sans-serif;
            letter-spacing: 5px;
            text-shadow: 0 0 20px darkred;
            margin-bottom: 40px;
            animation: shake 0.5s;
        }

        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }

        /* Responsive text for very long equations */
        .math-tiny { font-size: 1.8rem !important; }

    </style>
</head>
<body>

    <div id="start-screen" class="screen active">
        <h1>THE MATH GAME</h1>
        <button class="menu-btn btn-start" onclick="startGame()">START GAME</button>
        <button class="menu-btn btn-options" onclick="showScreen('options-screen')">OPTIONS</button>
    </div>

    <div id="options-screen" class="screen">
        <h1>OPTIONS</h1>
        
        <div class="option-group">
            <label for="time-slider">Time Limit per Question</label>
            <input type="range" id="time-slider" min="2" max="10" value="5" step="1" oninput="updateTimeLabel()">
            <div id="time-label" class="value-display">5 Seconds</div>
        </div>

        <button class="menu-btn btn-options" onclick="showScreen('start-screen')">BACK</button>
    </div>

    <div id="game-screen" class="screen">
        <div id="timer-container">
            <div id="timer-bar"></div>
        </div>
        
        <div id="q-number-display">Q.1</div>
        <div id="question-text">Ready?</div>

        <div class="btn-container">
            <button id="btn-true" class="game-btn" onclick="handleInput(true)">True</button>
            <button id="btn-false" class="game-btn" onclick="handleInput(false)">False</button>
        </div>
    </div>

    <div id="loser-screen" class="screen">
        <div id="loser-text">LOSER</div>
        <button class="menu-btn btn-options" style="border: 2px solid red; background:transparent; color:red;" onclick="showScreen('start-screen')">MAIN MENU</button>
    </div>

    <script>
        // --- GLOBAL SETTINGS ---
        let timeLimitSeconds = 5; // Default from prompt
        let currentLevel = 1;
        let isGameActive = false;
        let timerInterval;
        let currentAnswer = true;
        
        // --- DOM ELEMENTS ---
        const timerBar = document.getElementById('timer-bar');
        const qNumDisplay = document.getElementById('q-number-display');
        const qTextDisplay = document.getElementById('question-text');
        const timeSlider = document.getElementById('time-slider');
        const timeLabel = document.getElementById('time-label');

        // --- NAVIGATION LOGIC ---
        function showScreen(screenId) {
            // Hide all screens
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            // Show target screen
            document.getElementById(screenId).classList.add('active');
        }

        function updateTimeLabel() {
            timeLimitSeconds = timeSlider.value;
            timeLabel.textContent = `${timeLimitSeconds} Seconds`;
        }

        // --- MATH GENERATORS ---

        // Level 1-5: Solvable Math
        function generateEasyMath(wantTrue) {
            const a = Math.floor(Math.random() * 10) + 1;
            const b = Math.floor(Math.random() * 10) + 1;
            const ops = ['+', '-', '*'];
            const op = ops[Math.floor(Math.random() * 3)];
            
            let res;
            if(op === '+') res = a + b;
            if(op === '-') res = a - b;
            if(op === '*') res = a * b;

            // Manipulate result if we want False
            let displayRes = wantTrue ? res : res + (Math.floor(Math.random() * 3) + 1);
            if (!wantTrue && displayRes === res) displayRes++; // fallback

            return `${a} ${op} ${b} = ${displayRes}`;
        }

        // Level 6+: THE IMPOSSIBLE LIST (25+ Types)
        // Returns string. Logic relies on Odd/Even question number.
        function generateHardMath() {
            const bigA = Math.floor(Math.random() * 90000) + 10000;
            const bigB = Math.floor(Math.random() * 90000) + 10000;
            
            const types = [
                // 1. Calculus
                () => `∫ x³ dx = ¼x⁴ + C`,
                () => `lim(x→0) (sin x)/x = 1`,
                () => `d/dx (ln x) = 1/x`,
                () => `∫ e^x dx = e^x`,
                () => `∂f/∂x = 2xy + z`,
                // 2. Trigonometry
                () => `cos(2θ) = cos²θ - sin²θ`,
                () => `tan(45°) = 1`,
                () => `csc(x) = 1/sin(x)`,
                // 3. Logarithms
                () => `ln(e) = 1`,
                () => `log₂8 = 3`,
                // 4. Linear Algebra
                () => `det(I) = 1`,
                () => `A × A⁻¹ = I`,
                () => `|v| = √(x² + y² + z²)`,
                () => `u · v = 0 (orthogonal)`,
                // 5. Complex Numbers
                () => `i² = -1`,
                () => `|a + bi| = √(a² + b²)`,
                // 6. Set Theory / Logic
                () => `A ∪ A' = U`,
                () => `A ∩ B ⊆ A`,
                () => `(P → Q) ⇔ (¬Q → ¬P)`,
                () => `∀x ∈ ℝ, x² ≥ 0`,
                // 7. Series
                () => `∑(1/n²) = π²/6`,
                () => `1 + r + r²... = 1/(1-r)`,
                // 8. Number Theory
                () => `x ≡ 5 (mod 2)`,
                () => `gcd(12, 18) = 6`,
                // 9. Constants & Physics
                () => `E = mc²`,
                () => `F = G(m₁m₂)/r²`,
                () => `PV = nRT`,
                // 10. Scary Arithmetic
                () => `${bigA} + ${bigB} = ?`,
                () => `√${bigA} = ?`,
                () => `${Math.floor(Math.random()*100)}!`
            ];

            const t = types[Math.floor(Math.random() * types.length)];
            return t();
        }

        // --- GAMEPLAY LOGIC ---

        function startGame() {
            currentLevel = 1;
            isGameActive = true;
            showScreen('game-screen');
            nextQuestion();
        }

        function gameOver() {
            isGameActive = false;
            clearTimeout(timerInterval);
            showScreen('loser-screen');
        }

        function startTimer() {
            // Reset visuals
            timerBar.style.transition = 'none';
            timerBar.style.width = '100%';
            
            // Reflow
            void timerBar.offsetWidth;

            // Animate using the Definite Time Setting
            timerBar.style.transition = `width ${timeLimitSeconds}s linear`;
            timerBar.style.width = '0%';

            clearTimeout(timerInterval);
            timerInterval = setTimeout(() => {
                if(isGameActive) gameOver();
            }, timeLimitSeconds * 1000);
        }

        function nextQuestion() {
            if (!isGameActive) return;

            startTimer();

            // 1. Determine Correct Answer
            const isTrue = Math.random() < 0.5;
            currentAnswer = isTrue;

            // 2. Fake Question Number Logic
            // True = Even, False = Odd
            const base = Math.floor(Math.random() * 400) + 10;
            let fakeNum = isTrue ? (base * 2) : (base * 2 + 1);

            qNumDisplay.textContent = `Q.${fakeNum}`;

            // 3. Generate Question
            if (currentLevel <= 5) {
                // Easy mode: Text must match Truth
                qTextDisplay.textContent = generateEasyMath(isTrue);
                qTextDisplay.classList.remove('math-tiny');
            } else {
                // Hard mode: Text is random, only look at Q number
                let text = generateHardMath();
                qTextDisplay.textContent = text;
                
                // If text is super long, shrink font
                if(text.length > 20) {
                    qTextDisplay.classList.add('math-tiny');
                } else {
                    qTextDisplay.classList.remove('math-tiny');
                }
            }

            currentLevel++;
        }

        function handleInput(playerChoice) {
            if(!isGameActive) return;

            if(playerChoice === currentAnswer) {
                // Correct
                clearTimeout(timerInterval); // Brief pause logic
                nextQuestion();
            } else {
                // Wrong
                gameOver();
            }
        }
    </script>
</body>
</html>
