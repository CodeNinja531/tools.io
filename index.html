<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Countdown Timer</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom font import for a modern look */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* Light gray background */
        }
        /* Custom utility for table font to ensure alignment */
        .monospace-table {
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4 bg-gray-50">

    <div class="w-full max-w-2xl bg-white shadow-xl rounded-2xl p-6 md:p-10">
        <h1 class="text-3xl font-extrabold text-center text-gray-800 mb-6 border-b-2 pb-2">
            Student Exam Countdown
        </h1>

        <!-- 1. Input Section -->
        <div id="input-section" class="flex flex-col sm:flex-row items-center justify-center p-4 bg-blue-50 rounded-lg shadow-inner mb-8">
            <label class="font-bold text-lg text-gray-700 mb-2 sm:mb-0 sm:mr-4">Set Time (HH:MM:SS):</label>
            <div class="flex items-center space-x-2">
                <input id="h-input" type="number" min="0" max="99" value="01" class="w-16 p-2 text-center text-xl font-bold rounded-lg border-2 border-blue-300 focus:border-blue-500 transition"/>
                <span class="text-xl font-bold text-gray-700">:</span>
                <input id="m-input" type="number" min="0" max="59" value="30" class="w-16 p-2 text-center text-xl font-bold rounded-lg border-2 border-blue-300 focus:border-blue-500 transition"/>
                <span class="text-xl font-bold text-gray-700">:</span>
                <input id="s-input" type="number" min="0" max="59" value="00" class="w-16 p-2 text-center text-xl font-bold rounded-lg border-2 border-blue-300 focus:border-blue-500 transition"/>
            </div>
            <button id="set-button" onclick="setTimer()" 
                    class="mt-4 sm:mt-0 sm:ml-6 px-6 py-2 bg-green-600 text-white font-bold rounded-xl shadow-lg hover:bg-green-700 transition transform hover:scale-105 active:scale-95">
                Set Timer
            </button>
        </div>

        <!-- 2. Timer Display -->
        <div class="p-6 bg-gray-900 rounded-2xl shadow-2xl mb-8">
            <!-- Adjusted classes for better responsiveness -->
            <p id="timer-display" class="text-6xl sm:text-7xl md:text-8xl lg:text-9xl font-black text-center text-green-400 monospace-table">
                01:30:00.0
            </p>
        </div>
        
        <!-- 3. Control Button -->
        <button id="submit-button" onclick="submitRecord()" disabled
                class="w-full px-8 py-4 bg-blue-600 text-white font-extrabold text-xl rounded-xl shadow-xl hover:bg-blue-700 transition transform hover:scale-[1.02] active:scale-95 disabled:bg-gray-400 disabled:shadow-none mb-10">
            Submit (Record Time)
        </button>

        <!-- 4. Records Display Table -->
        <h2 class="text-2xl font-bold text-gray-700 mb-4">Submission Log</h2>
        <div class="overflow-x-auto bg-gray-100 rounded-lg border border-gray-300 shadow-inner">
            <table class="min-w-full divide-y divide-gray-300">
                <thead class="bg-gray-200">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider">
                            Name
                        </th>
                        <th class="px-6 py-3 text-right text-xs font-bold text-gray-700 uppercase tracking-wider">
                            Time Remaining
                        </th>
                    </tr>
                </thead>
                <tbody id="records-body" class="bg-white divide-y divide-gray-200 monospace-table">
                    <!-- Records will be inserted here -->
                </tbody>
            </table>
            <p id="no-records-message" class="text-center text-gray-500 py-4 italic">No submissions yet.</p>
        </div>
    </div>

    <script>
        // --- Global State ---
        let targetEndTime = null;
        let isRunning = false;
        let timerInterval = null;
        
        // --- Element References ---
        const hInput = document.getElementById('h-input');
        const mInput = document.getElementById('m-input');
        const sInput = document.getElementById('s-input');
        const timerDisplay = document.getElementById('timer-display');
        const setButton = document.getElementById('set-button');
        const submitButton = document.getElementById('submit-button');
        const recordsBody = document.getElementById('records-body');
        const noRecordsMessage = document.getElementById('no-records-message');


        /**
         * Parses input time, sets the target end time, and starts the countdown.
         */
        function setTimer() {
            // Stop any existing timer to reset
            if (timerInterval) {
                clearInterval(timerInterval);
            }

            try {
                const hours = parseInt(hInput.value || 0);
                const minutes = parseInt(mInput.value || 0);
                const seconds = parseInt(sInput.value || 0);

                const durationInSeconds = (hours * 3600) + (minutes * 60) + seconds;

                if (durationInSeconds <= 0) {
                    timerDisplay.textContent = "00:00:00.0";
                    timerDisplay.classList.add('text-red-500');
                    alertMessage("Please set a valid time greater than zero.");
                    return;
                }

                // Calculate the exact time when the countdown should end
                targetEndTime = Date.now() + (durationInSeconds * 1000);
                isRunning = true;
                
                // Update button states
                setButton.disabled = true;
                setButton.classList.add('opacity-50', 'cursor-not-allowed');
                submitButton.disabled = false;
                submitButton.classList.remove('disabled:bg-gray-400', 'disabled:shadow-none');

                timerDisplay.classList.remove('text-red-500', 'text-gray-500');
                timerDisplay.classList.add('text-green-400');
                
                // Start the high-precision interval (100ms)
                timerInterval = setInterval(updateTimer, 100);
                updateTimer(); // Initial call to display time immediately

            } catch (error) {
                alertMessage("Invalid time input. Please use numbers only.");
            }
        }

        /**
         * Calculates the remaining time and updates the display.
         */
        function updateTimer() {
            if (!isRunning) {
                return;
            }

            const now = Date.now();
            let timeRemainingMs = targetEndTime - now;

            if (timeRemainingMs <= 0) {
                // Timer finished
                clearInterval(timerInterval);
                isRunning = false;
                timerDisplay.textContent = "00:00:00.0";
                timerDisplay.classList.remove('text-green-400');
                timerDisplay.classList.add('text-red-500');
                
                setButton.disabled = false;
                setButton.classList.remove('opacity-50', 'cursor-not-allowed');
                submitButton.disabled = true;
                submitButton.classList.add('disabled:bg-gray-400', 'disabled:shadow-none');
                
                alertMessage("Time's up!");
                return;
            }

            // Convert milliseconds to HH:MM:SS.T format
            const totalSeconds = timeRemainingMs / 1000;
            const hours = Math.floor(totalSeconds / 3600);
            const minutes = Math.floor((totalSeconds % 3600) / 60);
            const seconds = Math.floor(totalSeconds % 60);
            // Get the tenths digit
            const tenths = Math.floor((totalSeconds * 10) % 10); 

            const timeStr = [
                String(hours).padStart(2, '0'),
                String(minutes).padStart(2, '0'),
                String(seconds).padStart(2, '0')
            ].join(':') + `.${tenths}`;

            timerDisplay.textContent = timeStr;
        }

        /**
         * Prompts for student name and adds a record to the table.
         * The timer continues to run.
         */
        function submitRecord() {
            if (!isRunning) {
                alertMessage("The timer is not running.");
                return;
            }
            
            // Get the time string immediately (HH:MM:SS.T)
            const remainingTime = timerDisplay.textContent;

            // Use browser prompt for simplicity (since we can't use tkinter's simpledialog)
            const studentName = prompt("Enter the student's name:");

            if (studentName) {
                addRecordToTable(studentName, remainingTime);
            }
            // Timer continues running if user cancels or submits
        }

        /**
         * Adds a new row to the submission log table.
         * @param {string} name - The student's name.
         * @param {string} time - The remaining time (HH:MM:SS.T).
         */
        function addRecordToTable(name, time) {
            // Remove the 'No submissions yet' message if it exists
            if (noRecordsMessage) {
                noRecordsMessage.classList.add('hidden');
            }

            const newRow = recordsBody.insertRow(0); // Insert at the top
            
            // Name cell (left aligned)
            const nameCell = newRow.insertCell(0);
            nameCell.innerHTML = `<span class="font-semibold text-gray-800">${name}</span>`;
            nameCell.className = "px-6 py-3 whitespace-nowrap text-sm text-left";

            // Time Remaining cell (right aligned, monospace for alignment)
            const timeCell = newRow.insertCell(1);
            timeCell.textContent = time;
            timeCell.className = "px-6 py-3 whitespace-nowrap text-sm text-right font-bold text-blue-600";
        }

        /**
         * Simple custom alert box implementation (since alert() is discouraged).
         * For this simple scenario, we'll use console log and temporary text on the display.
         */
        function alertMessage(message) {
            console.error("ALERT:", message);
            // Flashing temporary message on the timer display
            const originalText = timerDisplay.textContent;
            const originalColor = timerDisplay.classList.contains('text-green-400') ? 'text-green-400' : 'text-gray-500';

            timerDisplay.textContent = message;
            timerDisplay.classList.remove(originalColor);
            timerDisplay.classList.add('text-yellow-500', 'animate-pulse');

            setTimeout(() => {
                timerDisplay.textContent = originalText;
                timerDisplay.classList.remove('text-yellow-500', 'animate-pulse');
                timerDisplay.classList.add(originalColor);
            }, 2000);
        }

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            // Ensure input values are correct on load
            hInput.value = '01';
            mInput.value = '30';
            sInput.value = '00';
            
            // Initial style setup for disabled button
            submitButton.classList.add('disabled:bg-gray-400', 'disabled:shadow-none');
            timerDisplay.classList.add('text-gray-500');
        });
        
    </script>

</body>
</html>
